<style>
  .image-with-text {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: var(--space-xl) var(--space-m);
    width: 100%;
    gap: var(--space-xl);
  }

  .image-with-text--right {
    flex-direction: row-reverse;
  }

  .image-with-text__media {
    flex: 1;
    position: relative;
    width: 100%;
    max-width: 900px;
  }

  .image-with-text__content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: var(--space-m);
    max-width: 80ch;
  }

  .image-with-text__first-image-container {
    position: relative;
    z-index: 2;
    max-width: 900px;
    width: 100%;
  }

  .image-with-text__second-image-container {
    position: absolute;
    top: var(--space-l);
    left: var(--space-l);
    z-index: 1;
    max-width: 900px;
    width: 100%;
  }

  .image-with-text--right .image-with-text__second-image-container {
    left: calc(-1 * var(--space-l));
  }

  .image-with-text__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center center;
    display: block;
  }

  .image-with-text__second-image {
    filter: grayscale(100%) opacity(70%);
  }

  .image-with-text__title {
    text-transform: uppercase;
    color: var(--neutral-950);
  }

  .image-with-text__description {
    color: var(--neutral-600);
  }

  @media screen and (max-width: 768px) {
    .image-with-text,
    .image-with-text--right {
      flex-direction: column;
      gap: var(--space-l);
    }

    .image-with-text__content {
      width: 100%;
    }

    .image-with-text__media {
      width: 100%;
    }

    .image-with-text__second-image-container {
      top: var(--space-m);
      left: var(--space-m);
    }

    .image-with-text--right .image-with-text__second-image-container {
      left: var(--space-m);
    }
  }
</style>

<section
  id="image-with-text-{{ section.id }}"
  class="image-with-text {% if section.settings.alignment == 'right' %}image-with-text--right{% endif %}"
  aria-label="Image with text section"
>
  <div class="image-with-text__media">
    {% if section.settings.first_image != blank %}
      <figure class="image-with-text__first-image-container">
        {{
          section.settings.first_image
          | image_url: width: 900
          | image_tag: class: 'image-with-text__image', alt: section.settings.first_image.alt
          | default: section.settings.heading, width: 900, height: 600, loading: 'lazy'
        }}
      </figure>
    {% endif %}

    {% if section.settings.second_image != blank %}
      <figure class="image-with-text__second-image-container">
        {{
          section.settings.second_image
          | image_url: width: 900
          | image_tag:
            class: 'image-with-text__image image-with-text__second-image',
            alt: section.settings.second_image.alt
          | default: section.settings.heading, width: 900, height: 600, loading: 'lazy'
        }}
      </figure>
    {% endif %}
  </div>

  <div class="image-with-text__content">
    {% if section.settings.heading != blank %}
      <h2 class="image-with-text__title heading--2xl">
        {{ section.settings.heading }}
      </h2>
    {% endif %}

    {% if section.settings.text != blank %}
      <div class="image-with-text__description body">
        {{ section.settings.text }}
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Image With Text",
  "tag": "section",
  "settings": [
    {
      "type": "select",
      "id": "alignment",
      "label": "Image alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left",
      "info": "Determines if the image appears on the left or right side of the text"
    },
    {
      "type": "image_picker",
      "id": "first_image",
      "label": "First image",
      "info": "Primary image that appears in the foreground"
    },
    {
      "type": "image_picker",
      "id": "second_image",
      "label": "Second image (optional)",
      "info": "Secondary image that appears behind the first image with a greyed-out appearance"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Image with text"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text content",
      "default": "<p>Pair text with an image to provide information about a product, collection, or brand story. Add details about availability, style, or even provide a review.</p>"
    }
  ],
  "presets": [
    {
      "name": "Image With Text",
      "category": "Image",
      "settings": {
        "heading": "Image With Text",
        "text": "<p>Pair text with an image to provide information about a product, collection, or brand story.</p>"
      }
    }
  ],
  "enabled_on": {
    "templates": ["index", "page", "article", "blog"]
  }
}
{% endschema %}
