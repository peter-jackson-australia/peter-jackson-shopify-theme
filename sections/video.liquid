<style>
  .video-container {
    position: relative;
    width: 100%;
    padding: var(--space-2xl) var(--space-m);
    overflow: hidden;
  }

  .video-container__video {
    width: 100%;
    display: block;
    position: relative;
  }

  .video-container__video > video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .video-container--full-width {
    width: 100%;
    max-width: 100%;
  }

  .video-container--contained {
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
    padding: 0 var(--space-m);
  }
</style>

{% assign width = section.settings.width %}
{% assign id = section.id %}
{% assign title = section.title %}
{% assign show_title = section.settings.show_title %}

{% assign show_top_border = section.settings.show_top_border %}
{% assign show_bottom_border = section.settings.show_bottom_border %}

{% assign poster_image = section.settings.poster_image %}
{% if poster_image %}
  {% assign poster_url = poster_image | image_url: width: 2000 %}
{% else %}
  {% assign poster_url = section.settings.poster_url %}
{% endif %}

{% assign vid = section.settings.video %}
{% assign aspect_ratio = section.settings.aspect_ratio %}
{% assign anchor_id = section.settings.anchor_id %}
{% assign autoplay = section.settings.autoplay %}
{% assign loop = section.settings.loop %}
{% assign muted = section.settings.muted %}

<div
  id="video-section-{{ id }}"
  class="video-container video-container--{{ width }}"
  aria-label="{{ title | escape }}"
  style="
    {% if show_top_border %}border-top: 1px solid var(--neutral-50);{% endif %}
    {% if show_bottom_border %}border-bottom: 1px solid var(--neutral-50);{% endif %}
  "
>
  {% if vid %}
    <div
      class="video-container__video"
      style="aspect-ratio: {% if aspect_ratio == '16-9' %}16/9{% elsif aspect_ratio == '4-3' %}4/3{% elsif aspect_ratio == '1-1' %}1/1{% else %}16/9{% endif %};"
      {% if anchor_id != blank %}
        id="{{ anchor_id | downcase | replace: ' ', '-' }}-segment"
      {% endif %}
    >
      {{
        vid
        | video_tag:
          controls: true,
          autoplay: autoplay,
          loop: loop,
          muted: muted,
          playsinline: true,
          class: 'video-container__video-element',
          poster: poster_url
      }}
    </div>
  {% else %}
    <div class="video-container__placeholder body">
      {{ 'Please upload a video' }}
    </div>
  {% endif %}

  {% if title != blank and show_title %}
    <div class="video-container__title" style="margin-top: var(--space-s);">
      <p class="heading--xl">{{ title }}</p>
    </div>
  {% endif %}
</div>

{% schema %}
{
  "name": "Video",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "anchor_id",
      "label": "Anchor ID (lowercase with hyphens)",
      "info": "Example: history or about-us"
    },
    {
      "type": "checkbox",
      "id": "show_top_border",
      "label": "Show top border",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_bottom_border",
      "label": "Show bottom border",
      "default": false
    },
    {
      "type": "video",
      "id": "video",
      "label": "Video",
      "info": "Upload or select a video. MP4 format recommended."
    },
    {
      "type": "image_picker",
      "id": "poster_image",
      "label": "Poster Image",
      "info": "Image shown before video plays. For best results, use an image with the same aspect ratio as your video."
    },
    {
      "type": "text",
      "id": "title",
      "label": "Video title",
      "info": "For accessibility and can be displayed below video"
    },
    {
      "type": "checkbox",
      "id": "show_title",
      "label": "Show title below video",
      "default": false
    },
    {
      "type": "select",
      "id": "width",
      "label": "Video width",
      "options": [
        {
          "value": "contained",
          "label": "Contained"
        },
        {
          "value": "full-width",
          "label": "Full width"
        }
      ],
      "default": "contained"
    },
    {
      "type": "select",
      "id": "aspect_ratio",
      "label": "Aspect ratio",
      "options": [
        {
          "value": "16-9",
          "label": "16:9"
        },
        {
          "value": "4-3",
          "label": "4:3"
        },
        {
          "value": "1-1",
          "label": "1:1 (Square)"
        }
      ],
      "default": "16-9"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay video",
      "default": false,
      "info": "Most browsers require videos to be muted for autoplay to work"
    },
    {
      "type": "checkbox",
      "id": "loop",
      "label": "Loop video",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "muted",
      "label": "Mute video",
      "default": false,
      "info": "Note: Some browsers may require videos to be muted to play automatically"
    }
  ],
  "presets": [
    {
      "name": "Video",
      "category": "Media",
      "settings": {
        "width": "contained",
        "aspect_ratio": "16-9"
      }
    }
  ],
  "enabled_on": {
    "templates": ["index", "page", "article", "blog"]
  }
}
{% endschema %}
