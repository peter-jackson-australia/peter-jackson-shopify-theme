{{ 'section-counter.css' | asset_url | stylesheet_tag }}

<div
  id="counter-{{ section.id }}"
  style="{% if section.settings.show_top_border %}border-top: solid 1px var(--neutral-50);{% endif %}{% if section.settings.show_bottom_border %} border-bottom: solid 1px var(--neutral-600);{% endif %}"
>
  <div class="counter__header">
    {% if section.settings.heading != blank %}
      <h2 class="heading--2xl">{{ section.settings.heading }}</h2>
    {% endif %}
    {% if section.settings.subheading != blank %}
      <p class="counter__header-subheading">{{ section.settings.subheading }}</p>
    {% endif %}
  </div>

  <div
    class="counter__container"
    style="
      {% case section.blocks | size %}
      {% when 1 %}
        grid-template-columns: 1fr;
      {% when 2 %}
        grid-template-columns: repeat(2, 1fr);
      {% else %}
        grid-template-columns: repeat(3, 1fr);
      {% endcase %}
    "
  >
    {% for counter in section.blocks %}
      <div class="counter__counters">
        <p class="heading--xl">{{ counter.settings.counter_description }}</p>
        <p
          class="countervalue__main-value heading--3xl"
          id="counter-{{ section.id }}-value-{{ forloop.index }}"
          data-prefix="{{ counter.settings.counter_text_prefix }}"
          data-suffix="{{ counter.settings.counter_text_suffix }}"
          data-initial="{{ counter.settings.counter_initial_value }}"
          data-final="{{ counter.settings.counter_final_value }}"
          data-duration="{{ counter.settings.counter_duration }}"
        >
          {{ counter.settings.counter_initial_value }}
        </p>
      </div>
    {% endfor %}
  </div>
</div>

<script
  src="{{ "section-counter.js" | asset_url }}"
  data-section-id="{{ section.id }}"
  defer
></script>

{% schema %}
{
  "name": "Counter",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Some text here"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "More text here"
    },
    {
      "type": "checkbox",
      "id": "show_top_border",
      "label": "Show top border",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "show_bottom_border",
      "label": "Show bottom border",
      "default": false
    }
  ],
  "max_blocks": 3,
  "blocks": [
    {
      "type": "counter",
      "name": "Counter",
      "settings": [
        {
          "id": "counter_description",
          "label": "Counter Description",
          "type": "text",
          "default": "This counter goes from 0 to 100"
        },
        {
          "id": "counter_duration",
          "label": "Counter Animation Duration (Seconds)",
          "type": "number",
          "default": 5
        },
        {
          "id": "counter_text_prefix",
          "label": "Text Before Counter Value",
          "type": "text"
        },
        {
          "type": "paragraph",
          "content": "This is used to add text before the counter's value. For example, if you wanted '*20', this value would be '*'"
        },
        {
          "id": "counter_initial_value",
          "label": "Counter Start Number",
          "type": "number",
          "default": 0
        },
        {
          "type": "paragraph",
          "content": "The initial number is where the counter starts at. If this value is left blank, it will be 10% of the final number"
        },
        {
          "id": "counter_final_value",
          "label": "Counter Final Number",
          "type": "number",
          "default": 100
        },
        {
          "type": "paragraph",
          "content": "This is where the counter will finish"
        },
        {
          "id": "counter_text_suffix",
          "label": "Text After Counter Value",
          "type": "text"
        },
        {
          "type": "paragraph",
          "content": "This is used to add text before the counter's value. For example, if you wanted '7/9', this value would be '/9"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Counter"
    }
  ]
}
{% endschema %}
