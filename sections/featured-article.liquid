{{ 'section-featured-article.css' | asset_url | stylesheet_tag }}

<div class="featured-article" id="section-{{ section.id }}">
  {% if section.settings.heading != blank %}
    <h2 class="heading--xl featured-article__heading featured-article__heading--{{ section.settings.heading_alignment }}">
      {{ section.settings.heading }}
    </h2>
  {% endif %}

  <div class="featured-article__slider-wrapper">
    <div class="featured-article__slider splide">
      <div class="splide__arrows">
        <button class="splide__arrow splide__arrow--prev">{% render '_icon-arrow-see-less' %}</button>
        <button class="splide__arrow splide__arrow--next">{% render '_icon-arrow-see-more' %}</button>
      </div>
      <div class="splide__track">
        <div class="splide__list">
          {% for article in blogs['the-jackson-journal'].articles limit: 100 %}
            {% if article.metafields.custom.featured_article == true %}
              <article class="splide__slide featured-article__slide">
                <a href="{{ article.url }}" class="featured-article__card-link">
                  {% if article.image %}
                    <div class="featured-article__image-wrapper">
                      <img
                        src="{{ article.image | image_url: width: 600 }}"
                        alt="{{ article.image.alt | escape }}"
                        loading="lazy"
                        width="{{ article.image.width }}"
                        height="{{ article.image.height }}"
                        class="featured-article__image"
                        decoding="async"
                      >
                    </div>
                  {% endif %}
                  <h3 class="heading--l featured-article__title">{{ article.title }}</h3>
                  <span class="body featured-article__read-more">
                    Read More
                    {% render '_icon-arrow-submit-dark' %}
                  </span>
                </a>
              </article>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const splideElement = document.querySelector('.featured-article__slider');

    if (splideElement) {
      new Splide(splideElement, {
        type: 'loop',
        perPage: 4.5,
        perMove: 1,
        gap: 'var(--space-2xs)',
        arrows: false,
        pagination: false,
        drag: true,
        snap: true,
        breakpoints: {
          1200: {
            perPage: 3,
            arrows: true,
          },
          768: {
            perPage: 2,
            arrows: true,
          },
          470: {
            perPage: 1,
            arrows: true,
          },
        },
      }).mount();
    }
  });
</script>

{% schema %}
{
  "name": "Featured Articles",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Articles"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Heading Alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    }
  ],
  "presets": [
    {
      "name": "Featured Articles",
      "category": "Blog"
    }
  ]
}
{% endschema %}
