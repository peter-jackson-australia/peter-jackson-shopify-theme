{% comment %}
Auto-generated by Shogun-AB.
This file can be re-written at any time.
{% endcomment %}


{% if article %}
  {% assign content = article %}
{% elsif blog %}
  {% assign content = blog %}
{% elsif page %}
  {% assign content = page %}
{% elsif product %}
  {% assign content = product %}
{% elsif collection %}
  {% assign content = collection %}
{% elsif metaobject %}
  {% assign content = metaobject.system %}
{% endif %}

<script type="text/javascript">
  var K=Object.defineProperty;var j=(h,u,m)=>u in h?K(h,u,{enumerable:!0,configurable:!0,writable:!0,value:m}):h[u]=m;var s=(h,u,m)=>j(h,typeof u!="symbol"?u+"":u,m);(function(){"use strict";/*! js-cookie v3.0.5 | MIT */function h(a){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)a[i]=t[i]}return a}var u={read:function(a){return a[0]==='"'&&(a=a.slice(1,-1)),a.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(a){return encodeURIComponent(a).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function m(a,e){function t(r,o,n){if(!(typeof document>"u")){n=h({},e,n),typeof n.expires=="number"&&(n.expires=new Date(Date.now()+n.expires*864e5)),n.expires&&(n.expires=n.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var d in n)n[d]&&(c+="; "+d,n[d]!==!0&&(c+="="+n[d].split(";")[0]));return document.cookie=r+"="+a.write(o,r)+c}}function i(r){if(!(typeof document>"u"||arguments.length&&!r)){for(var o=document.cookie?document.cookie.split("; "):[],n={},c=0;c<o.length;c++){var d=o[c].split("="),_=d.slice(1).join("=");try{var v=decodeURIComponent(d[0]);if(n[v]=a.read(_,v),r===v)break}catch{}}return r?n[r]:n}}return Object.create({set:t,get:i,remove:function(r,o){t(r,"",h({},o,{expires:-1}))},withAttributes:function(r){return m(this.converter,h({},this.attributes,r))},withConverter:function(r){return m(h({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(a)}})}var E=m(u,{path:"/"}),V=" daum[ /]| deusu/| yadirectfetcher|(?:^|[^g])news(?!sapphire)|(?<! (?:channel/|google/))google(?!(app|/google| pixel))|(?<! cu)bots?(?:\\b|_)|(?<!(?:lib))http|(?<![hg]m)score|(?<!cam)scan|@[a-z][\\w-]+\\.|\\(\\)|\\.com\\b|\\btime/|\\||^<|^[\\w \\.\\-\\(?:\\):%]+(?:/v?\\d+(?:\\.\\d+)?(?:\\.\\d{1,10})*?)?(?:,|$)|^[^ ]{50,}$|^\\d+\\b|^\\w*search\\b|^\\w+/[\\w\\(\\)]*$|^active|^ad muncher|^amaya|^avsdevicesdk/|^biglotron|^bot|^bw/|^clamav[ /]|^client/|^cobweb/|^custom|^ddg[_-]android|^discourse|^dispatch/\\d|^downcast/|^duckduckgo|^email|^facebook|^getright/|^gozilla/|^hobbit|^hotzonu|^hwcdn/|^igetter/|^jeode/|^jetty/|^jigsaw|^microsoft bits|^movabletype|^mozilla/\\d\\.\\d\\s[\\w\\.-]+$|^mozilla/\\d\\.\\d\\s\\(compatible;?(?:\\s\\w+\\/\\d+\\.\\d+)?\\)$|^navermailapp|^netsurf|^offline|^openai/|^owler|^php|^postman|^python|^rank|^read|^reed|^rest|^rss|^snapchat|^space bison|^svn|^swcd |^taringa|^thumbor/|^track|^w3c|^webbandit/|^webcopier|^wget|^whatsapp|^wordpress|^xenu link sleuth|^yahoo|^yandex|^zdm/\\d|^zoom marketplace/|^{{.*}}$|analyzer|archive|ask jeeves/teoma|audit|bit\\.ly/|bluecoat drtr|browsex|burpcollaborator|capture|catch|check\\b|checker|chrome-lighthouse|chromeframe|classifier|cloudflare|convertify|crawl|cypress/|dareboost|datanyze|dejaclick|detect|dmbrowser|download|evc-batch/|exaleadcloudview|feed|firephp|functionize|gomezagent|grab|headless|httrack|hubspot marketing grader|hydra|ibisbrowser|infrawatch|insight|inspect|iplabel|ips-agent|java(?!;)|library|linkcheck|mail\\.ru/|manager|measure|neustar wpm|node|nutch|offbyone|onetrust|optimize|pageburst|pagespeed|parser|perl|phantomjs|pingdom|powermarks|preview|proxy|ptst[ /]\\d|retriever|rexx;|rigor|rss\\b|scrape|server|sogou|sparkler/|speedcurve|spider|splash|statuscake|supercleaner|synapse|synthetic|tools|torrent|transcoder|url|validator|virtuoso|wappalyzer|webglance|webkit2png|whatcms/|xtate/",D=/bot|crawl|http|lighthouse|scan|search|spider/i,g;function z(){if(g instanceof RegExp)return g;try{g=new RegExp(V,"i")}catch{g=D}return g}function S(a){return!!a&&z().test(a)}const P=a=>{const e=window.innerWidth<768||window.outerWidth<768?"mobile":"desktop";return a===e},O=(a,e)=>{const t=!!e,i=String(a)==="true";return t===i},w="shg_geo_data";function k(a,e){const t=a-e;return Math.floor(t/(1e3*60*60*24))}function A(){if(new URLSearchParams(window.location.search).get("shg_geo_cache")==="false")return null;let e=null;try{const t=localStorage.getItem(w);if(t){const i=JSON.parse(t),r=Date.now();i.timestamp&&k(r,i.timestamp)<=7?e=i:localStorage.removeItem(w)}}catch(t){return console.error("Error reading geo data from cache:",t),localStorage.removeItem(w),null}return e}function C(a){let e=null;if(!a)return console.warn("Geo location API URL not configured."),e;try{const t=new XMLHttpRequest;t.open("GET",a,!1),t.send(null),t.status===200?(e=JSON.parse(t.responseText),e?(e.timestamp=Date.now(),localStorage.setItem(w,JSON.stringify(e))):(console.error("Geo API response parsed to null or undefined."),e=null)):console.error(`Geo API request failed with status: ${t.status}`)}catch(t){console.error("Error fetching geo data from API:",t)}return e}function M(a){let e=null;try{const t=A();t?(e=t,console.debug("Loaded geo data from cache:",e)):(e=C(a),console.debug("Fetched geo data from API:",e))}catch(t){console.error("Error initializing geo data:",t),e=null}return e}const R=(a,e)=>{const{type:t,countryCode:i,toponymName:r,parentName:o}=a||{},{country:n,region:c,city:d}=e||{};if(!t||!i||!e)return!1;switch(t){case"country":return n===i;case"region":return c===r&&n===i;case"city":return d===r&&c===o&&n===i;default:return console.debug("Unknown location type:",t),!1}},L=a=>typeof a!="string"?!1:document.referrer.toLowerCase().includes(a.toLowerCase()),F=a=>typeof a!="string"?!1:window.location.href.toLowerCase().includes(a.toLowerCase()),B=(a,e,t)=>{if(!e)return!1;const{expectedTimeInMillseconds:i,withinOrAfter:r}=a||{};if(typeof i!="number"||!r)return!1;const o=e.first_visit_timestamp;return r==="within"?o+i>t:o+i<t},N=(a,e,t)=>e?t-e.first_visit_timestamp<18e5===a:a===!0,p=class p{constructor(e){s(this,"visitorDetails",null);s(this,"currentTime");s(this,"geoLocationApi");s(this,"customerId");s(this,"internalGeoData");s(this,"isGeoDataInitialized",!1);s(this,"checkers",{device:e=>P(e),logged_in:(e,t)=>O(e,this.customerId),new_visitor:(e,t)=>N(e,t.visitorDetails,t.currentTime),returning_visitor:(e,t)=>B(e,t.visitorDetails,t.currentTime),url_contains:e=>F(e),referrer_contains:e=>L(e),location:(e,t)=>R(e,t.geoData)});this.geoLocationApi=e.geoLocationApi,this.customerId=e.customerId,this.currentTime=Date.now(),this.initializeVisitorDetails()}initializeVisitorDetails(){var e;try{const t=localStorage.getItem(p.VISITOR_DETAILS_KEY);t&&(this.visitorDetails=JSON.parse(t),typeof((e=this.visitorDetails)==null?void 0:e.first_visit_timestamp)!="number"&&(console.warn("Invalid visitor details found in storage, resetting."),this.visitorDetails=null)),this.visitorDetails===null?(console.debug("Initializing new visitor details."),this.visitorDetails={first_visit_timestamp:this.currentTime},localStorage.setItem(p.VISITOR_DETAILS_KEY,JSON.stringify(this.visitorDetails))):console.debug("Loaded visitor details from storage:",this.visitorDetails)}catch(t){console.error("Error initializing visitor details:",t),localStorage.removeItem(p.VISITOR_DETAILS_KEY),this.visitorDetails={first_visit_timestamp:this.currentTime},localStorage.setItem(p.VISITOR_DETAILS_KEY,JSON.stringify(this.visitorDetails))}}check(e){const t=this.checkers[e.audience_type];if(!t)return console.warn(`Unknown audience type: ${e.audience_type}`),!1;e.audience_type==="location"&&!this.isGeoDataInitialized&&(console.debug("Location check required, initializing geoData..."),this.internalGeoData=M(this.geoLocationApi),this.isGeoDataInitialized=!0,console.debug("GeoData initialization result:",this.internalGeoData));const i={geoData:this.internalGeoData===void 0?null:this.internalGeoData,visitorDetails:this.visitorDetails,currentTime:this.currentTime};try{const r=!!t(e.value,i);return console.debug("Audience check result:",{audience:e,internalContext:i,matched:r}),e.condition==="is_not"?!r:r}catch(r){return console.error("Error during audience check:",{audience:e,internalContext:i,error:r}),!1}}};s(p,"VISITOR_DETAILS_KEY","_shg_ab_visitor_details");let b=p;class U{constructor(e,t){this.pageType=e,this.pageId=t}shogunLoaded(e){const t=()=>{var i,r;try{(r=(i=window.Shopify)==null?void 0:i.analytics)!=null&&r.publish?(console.debug("Firing shogun:load event",e),window.Shopify.analytics.publish("shogun:load",e)):console.warn("Shopify analytics not available to publish shogun:load event.")}catch(o){console.error("Error publishing shogun:load event:",o)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t):t()}trackVariantImpression(e,t){const i={page_type:this.pageType,page_id:this.pageId,app_type:t=="ab_test"?"ab_testing":"personalization"};i.optimization_id=e.optimization_id,i.variant_id=e.id,console.debug(`Tracking variant impression: optimization=${e.optimization_id}, variant=${e.id}`),this.shogunLoaded(i)}}const f=class f{constructor(){s(this,"ran",!1)}removePreviewBarIframe(){console.debug("Setting up preview bar iframe removal");const e=()=>{f.PREVIEW_BAR_IFRAME_IDS.forEach(t=>{const i=document.getElementById(t);i&&(console.debug(`Removing preview bar iframe with id: ${t}`),i.remove())})};e(),document.addEventListener("DOMContentLoaded",()=>{console.debug("DOM loaded, setting up mutation observer for preview bar");const t=new MutationObserver(i=>{i.forEach(r=>{r.addedNodes.forEach(o=>{if(o.nodeType===Node.ELEMENT_NODE){const n=o;f.PREVIEW_BAR_IFRAME_IDS.includes(n.id)&&(console.debug(`Detected and removing preview bar iframe with id: ${n.id} via observer`),n.remove())}})})});if(document.body)t.observe(document.body,{childList:!0,subtree:!0});else{const i=new MutationObserver(()=>{document.body&&(t.observe(document.body,{childList:!0,subtree:!0}),e(),i.disconnect())});i.observe(document.documentElement,{childList:!0})}e()})}run(){this.ran||(this.removePreviewBarIframe(),this.ran=!0)}};s(f,"PREVIEW_BAR_IFRAME_IDS",["preview-bar-iframe","PBarNextFrameWrapper"]);let y=f;class G{constructor(e){this.trackingService=e}extractViewParamFromFullTemplateKey(e){const t=e.split("/").pop().split(".");return t.slice(1,t.length-1).join(".")}async handleRedirect(e){const t=new URL(window.location.href),i=new URL(window.location.href);if(e.optimization.scope==="theme")i.searchParams.set("preview_theme_id",e.selectedVariant.config.theme_id);else if(e.optimization.scope==="url_redirect")i.pathname=e.selectedVariant.config.path;else{const r=this.extractViewParamFromFullTemplateKey(e.selectedVariant.config.full_template_key);i.searchParams.set("view",r)}t.toString()===i.toString()?this.hideViewParam():(i.searchParams.delete("cache"),console.debug("Redirecting to",i.toString()),window.location.replace(i))}hideViewParam(){const e=new URL(window.location.href);e.searchParams.delete("view"),window.history.replaceState({},"",e.toString())}dispatch(e){const t=e.find(r=>r.matchingVariant.id!==r.selectedVariant.id);if(console.debug("redirectingSelection",t),t)return this.handleRedirect(t);const i=new Set(e.map(r=>r.optimization.scope));(i.has("template")||i.has("page"))&&this.hideViewParam(),e.forEach(r=>{this.trackingService.trackVariantImpression(r.selectedVariant,r.optimization.type)})}}const l=class l{constructor(e){s(this,"cacheEnabled");s(this,"optimizations");s(this,"currentThemeId");s(this,"pageId");s(this,"pageType");s(this,"currentPartialTemplateKey");s(this,"distributionMethod");s(this,"sessionId");s(this,"cachedOptimizations");s(this,"audienceChecker");s(this,"personalizations");s(this,"abTests");s(this,"dispatcher");s(this,"currentPath");s(this,"themeTestHandler");s(this,"inAudience",e=>this.audienceChecker.check(e));this.currentThemeId=e.currentThemeId;const t=e.optimizations||[];e.defaultThemeId!==this.currentThemeId?this.optimizations=t.filter(c=>c.variants.some(d=>d.config.theme_id===this.currentThemeId)):this.optimizations=t,this.personalizations=this.optimizations.filter(c=>c.type==="personalization"),this.abTests=this.optimizations.filter(c=>c.type==="ab_test"),this.distributionMethod=e.distributionMethod||l.DEFAULT_DISTRIBUTION_METHOD,this.pageId=e.pageId,this.pageType=e.pageType,this.cacheEnabled=e.cacheEnabled;const i=this.pageType==="metaobject"?"templates/metaobject/":"templates/",r=[e.templateName,e.templateSuffix].filter(Boolean).join(".");this.currentPartialTemplateKey=i+r,this.currentPath=window.location.pathname,this.sessionId=e.sessionIdOverride||E.get(l.SHOPIFY_SESSION_COOKIE)||"",this.cachedOptimizations=JSON.parse(localStorage.getItem(l.OPTIMIZATIONS_CACHE_KEY)||"{}"),this.audienceChecker=new b(e);const o=new U(this.pageType,this.pageId),n=new y;this.themeTestHandler=n,this.dispatcher=new G(o)}getOptimizationPriority(e){return{theme:1,template:2,page:3,url_redirect:4}[e.scope]}sortMatches(e){return[...e].sort((t,i)=>{const r=this.getOptimizationPriority(t.optimization),o=this.getOptimizationPriority(i.optimization);return r===o?0:r-o})}audienceMatchesCurrentVisitor(e){const t=e.audiences||[];return t.length===0?!0:e.audiences_condition==="any"?t.some(this.inAudience):t.every(this.inAudience)}configAudiencesMatch(e,t){const i=e.audiences||[],r=t.audiences||[];if(i.length!==r.length)return!1;const o=i.map(c=>JSON.stringify(c)),n=r.map(c=>JSON.stringify(c));return!(o.some(c=>!n.includes(c))||n.some(c=>!o.includes(c))||i.length>1&&e.audiences_condition!==t.audiences_condition)}getCachedVariant(e){if(!this.cacheEnabled)return;const t=this.cachedOptimizations[e.id];if(t)return e.variants.find(i=>i.id===t)}setCachedVariant(e,t){this.cachedOptimizations[e.id]=t.id,console.debug("setCachedVariant",e.id,t.id),localStorage.setItem(l.OPTIMIZATIONS_CACHE_KEY,JSON.stringify(this.cachedOptimizations))}extractPartialTemplateKeyFromFullTemplateKey(e){if(!e)return;const t=e.split(".");return t.length<2?e:t.slice(0,-1).join(".")}matchesAnyAttributeOfCurrentPage(e,t){const i=e.config.page_id,r=e.config.page_type,o=this.extractPartialTemplateKeyFromFullTemplateKey(t.config.full_template_key),n=t.config.theme_id,c=t.config.path,d=o===this.currentPartialTemplateKey,_=n===this.currentThemeId,v=c===this.currentPath,T=!r||r===this.pageType,x=!i||i===this.pageId;return _||d&&(T&&x)||v}getMatchingVariant(e,t=void 0){var o;const i=e.config,r=(o=t==null?void 0:t.selectedVariant)==null?void 0:o.config;for(const n of e.variants){if(!this.matchesAnyAttributeOfCurrentPage(e,n))continue;const c=e.type==="ab_test"?e.config:n.config;if(this.audienceMatchesCurrentVisitor(c)&&!(r&&!this.configAudiencesMatch(i,r)))return n}}getPersonalizationMatches(){const e=[];for(const t of this.personalizations){const i=this.getMatchingVariant(t);i&&e.push({optimization:t,matchingVariant:i})}return e}getPrioritizedNonDefaultPersonalizationSelection(){const e=this.getPersonalizationMatches();if(e.length===0)return;const t=this.sortMatches(e);for(const i of t){const o=i.optimization.variants.sort((n,c)=>n.position-c.position).find(n=>!n.config.original&&this.audienceMatchesCurrentVisitor(n.config));if(o)return{optimization:i.optimization,matchingVariant:i.matchingVariant,selectedVariant:o}}}getDefaultPersonalizationSelectionsForImpressionTracking(e){return this.getPersonalizationMatches().filter(r=>r.matchingVariant.config.original&&r.optimization.id!==(e==null?void 0:e.optimization.id)).map(r=>({optimization:r.optimization,selectedVariant:r.matchingVariant,matchingVariant:r.matchingVariant}))}getRandomVariantForOptimization(e){const t=Math.random();let i=0;for(const r of e.variants)if(i+=(r.config.percentage||0)/100,i>t)return r;return e.variants[Math.floor(Math.random()*e.variants.length)]}hasAnyCachedVariants(){return this.cacheEnabled===!1?!1:this.abTests.some(e=>!!this.cachedOptimizations[e.id])}getGreedySelections(e){const t=e[Math.floor(Math.random()*e.length)],i=t.cachedVariant||this.getRandomVariantForOptimization(t.optimization);return[{optimization:t.optimization,selectedVariant:i,matchingVariant:t.matchingVariant}]}userBin(){const e=this.sessionId;let t=0;if(!e)return 0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return Math.abs(t)%l.DEFAULT_NUMBER_OF_BINS}getVariantForUserBin(){const e=this.userBin(),t=this.abTests.flatMap(r=>r.variants);let i=0;for(const r of t)if(i+=l.DEFAULT_NUMBER_OF_BINS*(r.traffic_percentage||0)/100,e<i)return r;return null}getEvenSelections(e){const t=this.getVariantForUserBin();if(!t)return[];const i=e.find(r=>r.optimization.variants.some(o=>o.id===t.id));return i?[{optimization:i.optimization,selectedVariant:t,matchingVariant:i.matchingVariant}]:[]}getAbTestMatches(e){const t=[];return this.abTests.forEach(i=>{const r=this.getMatchingVariant(i,e);if(r){const o=this.getCachedVariant(i);t.push({optimization:i,matchingVariant:r,cachedVariant:o})}}),t}getAbTestSelections(e){const t=this.getAbTestMatches(e);if(t.length===0)return[];const i=t.find(r=>!!r.cachedVariant);if(!i&&this.hasAnyCachedVariants())return[];if(i)return[{optimization:i.optimization,selectedVariant:i.cachedVariant,matchingVariant:i.matchingVariant}];switch(this.distributionMethod){case"greedy":return this.getGreedySelections(t);case"even":return this.getEvenSelections(t);default:throw new Error(`Unknown distribution method: ${this.distributionMethod}`)}}isBot(){const e=navigator.userAgent,t=S(e);return console.debug("Bot testing with user agent:",e),t}run(){if(this.isBot()){console.debug("Bot traffic detected, optimizer disabled");return}const e=this.getPrioritizedNonDefaultPersonalizationSelection(),t=this.getAbTestSelections(e);t.forEach(r=>{this.setCachedVariant(r.optimization,r.selectedVariant)});const i=[];e&&i.push(e),i.push(...t),i.push(...this.getDefaultPersonalizationSelectionsForImpressionTracking(e)),localStorage.getItem("_shg_is_merchant")||this.themeTestHandler.run(),i.length!==0&&this.dispatcher.dispatch(i)}};s(l,"DEFAULT_NUMBER_OF_BINS",1e4),s(l,"DEFAULT_DISTRIBUTION_METHOD","greedy"),s(l,"OPTIMIZATIONS_CACHE_KEY","_shg_ab_optimizations_cache"),s(l,"SHOPIFY_SESSION_COOKIE","_shopify_s");let I=l;window.ShogunOptimizer=I})();

</script>

<script type="text/javascript">
  ;(function() {
    if (typeof ShogunOptimizer === 'undefined') {
      console.error("ShogunOptimizer is not defined. Please ensure the optimizer script is properly loaded.");
      return;
    }

    const designMode = {{ request.design_mode | default: false }};
    if (designMode) {
      console.debug("Design mode is enabled, skipping optimizer initialization");
      return;
    }

    // If the referrer url is the Shopify admin url, then set a local storage shg_is_merchant flag to true
    // This is used to remove the preview bar from the page for shoppers
    const referrer = document.referrer
    if (!localStorage.getItem('_shg_is_merchant') && ((referrer.includes('admin.shopify.com') || referrer.includes('shogun')))) {
      console.debug('Setting shg_is_merchant to true')
      localStorage.setItem('_shg_is_merchant', 'true')
    }

    const urlParams = new URLSearchParams(window.location.search);
    const optimizationDisabled = urlParams.get('shg') === "false";

    if (optimizationDisabled) {
      console.debug("Optimization is disabled, skipping optimizer initialization");
      return;
    }

    const shopMetafieldConfig = {{ shop.metafields.shgabc.optimizations }} || {};
    const optimizationsData = shopMetafieldConfig.expires_at > Date.now() ? (shopMetafieldConfig.optimizations || []) : [];

    const optimizerConfig = {
      optimizations: optimizationsData,
      distributionMethod: urlParams.get('shgMethod') || shopMetafieldConfig.method,
      defaultThemeId: String(shopMetafieldConfig.default_theme_id),
      currentThemeId: "179206914416",
      pageId: "{{ content.id }}",
      pageType: "{% if article %}article{% elsif blog %}blog{% elsif page %}page{% elsif product %}product{% elsif collection %}collection{% elsif metaobject %}metaobject{% else %}homepage{% endif %}",
      templateName: "{{ template.name }}",
      templateSuffix: "{{ template.suffix }}",
      customerId: "{{ customer.id }}",
      cacheEnabled: urlParams.get('cache') !== "false",
      sessionIdOverride: urlParams.get('shgSessionId'),
      geoLocationApi: "https://ipinfo.io/json?token=f2ae3a557d807b"
    };

    console.debug("Initializing ShogunOptimizer with config:", optimizerConfig);
    const optimizer = new ShogunOptimizer(optimizerConfig);
    optimizer.run();
  })();
</script>
