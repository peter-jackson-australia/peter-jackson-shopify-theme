{% doc %}
  @prompt
    full width image with 3 text columns all evenly spaced.
    
    text columns include a heading, paragraph and call to action button all in the same style as the site CSS, make the section the height of the image uploaded and also give me the option to choose my heading tags. Body copy should match the paragraph text on site.
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-image-text-columns-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    {% if block.settings.background_image %}
      height: {{ block.settings.background_image.height | divided_by: block.settings.background_image.width | times: 100 }}vw;
      max-height: {{ block.settings.background_image.height }}px;
    {% else %}
      min-height: 500px;
    {% endif %}
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .ai-image-text-columns__background-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  .ai-image-text-columns__placeholder-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
  }

  .ai-image-text-columns__placeholder-{{ ai_gen_id }} svg {
    width: 100%;
    height: 100%;
    max-width: 300px;
    max-height: 300px;
    opacity: 0.3;
  }

  .ai-image-text-columns__overlay-{{ ai_gen_id }} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, {{ block.settings.overlay_opacity }});
    z-index: 2;
  }

  .ai-image-text-columns__content-{{ ai_gen_id }} {
    position: relative;
    z-index: 3;
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 60px 20px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 40px;
  }

  .ai-image-text-columns__column-{{ ai_gen_id }} {
    text-align: {{ block.settings.text_alignment }};
    color: {{ block.settings.text_color }};
  }

  .ai-image-text-columns__heading-{{ ai_gen_id }} {
    font-size: {{ block.settings.heading_size }}px;
    font-weight: 600;
    margin: 0 0 16px 0;
    line-height: 1.2;
    color: {{ block.settings.heading_color }};
  }

  .ai-image-text-columns__paragraph-{{ ai_gen_id }} {
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
    font-weight: inherit;
    margin: 0 0 24px 0;
    color: {{ block.settings.text_color }};
  }

  .ai-image-text-columns__button-{{ ai_gen_id }} {
    display: inline-block;
    padding: 12px 24px;
    background-color: {{ block.settings.button_bg_color }};
    color: {{ block.settings.button_text_color }};
    text-decoration: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    font-size: {{ block.settings.button_text_size }}px;
    font-weight: 500;
    transition: all 0.3s ease;
    border: 2px solid {{ block.settings.button_bg_color }};
  }

  .ai-image-text-columns__button-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.button_hover_bg_color }};
    color: {{ block.settings.button_hover_text_color }};
    border-color: {{ block.settings.button_hover_bg_color }};
  }

  .ai-image-text-columns__empty-state-{{ ai_gen_id }} {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    color: #666;
    font-size: 14px;
    text-align: center;
    z-index: 4;
  }

  @media screen and (max-width: 990px) {
    .ai-image-text-columns-{{ ai_gen_id }} {
      {% if block.settings.background_image %}
        height: {{ block.settings.background_image.height | divided_by: block.settings.background_image.width | times: 100 }}vw;
        max-height: {{ block.settings.background_image.height | times: 0.8 }}px;
      {% endif %}
    }

    .ai-image-text-columns__content-{{ ai_gen_id }} {
      grid-template-columns: repeat({{ block.settings.columns_tablet }}, 1fr);
      gap: 30px;
      padding: 50px 20px;
    }
  }

  @media screen and (max-width: 749px) {
    .ai-image-text-columns-{{ ai_gen_id }} {
      {% if block.settings.background_image %}
        height: {{ block.settings.background_image.height | divided_by: block.settings.background_image.width | times: 100 }}vw;
        max-height: {{ block.settings.background_image.height | times: 0.6 }}px;
      {% endif %}
    }

    .ai-image-text-columns__content-{{ ai_gen_id }} {
      grid-template-columns: repeat({{ block.settings.columns_mobile }}, 1fr);
      gap: 30px;
      padding: 40px 20px;
    }

    .ai-image-text-columns__heading-{{ ai_gen_id }} {
      font-size: {{ block.settings.heading_size | times: 0.8 }}px;
    }
  }
{% endstyle %}

<div class="ai-image-text-columns-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  {% if block.settings.background_image %}
    <img
      src="{{ block.settings.background_image | image_url: width: 2000 }}"
      alt="{{ block.settings.background_image.alt | escape }}"
      class="ai-image-text-columns__background-{{ ai_gen_id }}"
      loading="lazy"
      width="{{ block.settings.background_image.width }}"
      height="{{ block.settings.background_image.height }}"
    >
  {% else %}
    <div class="ai-image-text-columns__placeholder-{{ ai_gen_id }}">
      {{ 'hero-apparel-1' | placeholder_svg_tag }}
    </div>
  {% endif %}

  {% if block.settings.show_overlay %}
    <div class="ai-image-text-columns__overlay-{{ ai_gen_id }}"></div>
  {% endif %}

  <div class="ai-image-text-columns__content-{{ ai_gen_id }}">
    {% for i in (1..3) %}
      {% liquid
        assign heading_key = 'column_' | append: i | append: '_heading'
        assign text_key = 'column_' | append: i | append: '_text'
        assign button_text_key = 'column_' | append: i | append: '_button_text'
        assign button_link_key = 'column_' | append: i | append: '_button_link'

        assign heading = block.settings[heading_key]
        assign text = block.settings[text_key]
        assign button_text = block.settings[button_text_key]
        assign button_link = block.settings[button_link_key]
      %}

      <div class="ai-image-text-columns__column-{{ ai_gen_id }}">
        {% if heading != blank %}
          {% case block.settings.heading_tag %}
            {% when 'h1' %}
              <h1 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h1>
            {% when 'h2' %}
              <h2 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h2>
            {% when 'h3' %}
              <h3 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h3>
            {% when 'h4' %}
              <h4 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h4>
            {% when 'h5' %}
              <h5 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h5>
            {% when 'h6' %}
              <h6 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h6>
            {% else %}
              <h3 class="ai-image-text-columns__heading-{{ ai_gen_id }}">{{ heading }}</h3>
          {% endcase %}
        {% endif %}

        {% if text != blank %}
          <p class="ai-image-text-columns__paragraph-{{ ai_gen_id }}">{{ text }}</p>
        {% endif %}

        {% if button_text != blank %}
          <a
            href="{{ button_link | default: '#' }}"
            class="ai-image-text-columns__button-{{ ai_gen_id }}"
          >
            {{ button_text }}
          </a>
        {% endif %}
      </div>
    {% endfor %}
  </div>

  {% unless block.settings.background_image %}
    <div class="ai-image-text-columns__empty-state-{{ ai_gen_id }}">
      Next, add a background image
    </div>
  {% endunless %}
</div>

{% schema %}
{
  "name": "Image with text columns",
  "settings": [
    {
      "type": "header",
      "content": "Background image"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    },
    {
      "type": "checkbox",
      "id": "show_overlay",
      "label": "Show overlay",
      "default": true
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 1,
      "step": 0.1,
      "label": "Overlay opacity",
      "default": 0.4
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "columns_tablet",
      "label": "Columns on tablet",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        },
        {
          "value": "3",
          "label": "3"
        }
      ],
      "default": "2"
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "label": "Columns on mobile",
      "options": [
        {
          "value": "1",
          "label": "1"
        },
        {
          "value": "2",
          "label": "2"
        }
      ],
      "default": "1"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button text",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_bg_color",
      "label": "Button hover background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_hover_text_color",
      "label": "Button hover text",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "select",
      "id": "heading_tag",
      "label": "Heading tag",
      "options": [
        {
          "value": "h1",
          "label": "H1"
        },
        {
          "value": "h2",
          "label": "H2"
        },
        {
          "value": "h3",
          "label": "H3"
        },
        {
          "value": "h4",
          "label": "H4"
        },
        {
          "value": "h5",
          "label": "H5"
        },
        {
          "value": "h6",
          "label": "H6"
        }
      ],
      "default": "h3"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 28
    },
    {
      "type": "range",
      "id": "button_text_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button text size",
      "default": 14
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button border radius",
      "default": 4
    },
    {
      "type": "header",
      "content": "Column 1"
    },
    {
      "type": "text",
      "id": "column_1_heading",
      "label": "Heading",
      "default": "Premium Quality"
    },
    {
      "type": "textarea",
      "id": "column_1_text",
      "label": "Text",
      "default": "Discover our carefully curated collection of premium menswear, crafted with attention to detail and superior materials."
    },
    {
      "type": "text",
      "id": "column_1_button_text",
      "label": "Button text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "column_1_button_link",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Column 2"
    },
    {
      "type": "text",
      "id": "column_2_heading",
      "label": "Heading",
      "default": "Expert Tailoring"
    },
    {
      "type": "textarea",
      "id": "column_2_text",
      "label": "Text",
      "default": "Our experienced tailors ensure every garment fits perfectly, combining traditional craftsmanship with modern style."
    },
    {
      "type": "text",
      "id": "column_2_button_text",
      "label": "Button text",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "column_2_button_link",
      "label": "Button link"
    },
    {
      "type": "header",
      "content": "Column 3"
    },
    {
      "type": "text",
      "id": "column_3_heading",
      "label": "Heading",
      "default": "Personal Service"
    },
    {
      "type": "textarea",
      "id": "column_3_text",
      "label": "Text",
      "default": "Experience personalized styling advice and exceptional customer service from our knowledgeable team."
    },
    {
      "type": "text",
      "id": "column_3_button_text",
      "label": "Button text",
      "default": "Contact Us"
    },
    {
      "type": "url",
      "id": "column_3_button_link",
      "label": "Button link"
    }
  ],
  "presets": [
    {
      "name": "Image with text columns"
    }
  ]
}
{% endschema %}